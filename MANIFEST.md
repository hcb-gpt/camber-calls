# MANIFEST — camber-calls repo

> **Authoritative file placement guide.** Every agent MUST consult this before
> creating files. If your file doesn't fit a slot below, ask STRAT.

## Directory Index

```
camber-calls/
├── supabase/
│   ├── functions/            # Edge Functions (the pipeline)
│   │   ├── _shared/          #   shared utilities across functions
│   │   ├── ai-router/        #   AI attribution router
│   │   ├── context-assembly/ #   context assembly for attribution
│   │   ├── process-call/     #   call intake + persist
│   │   ├── segment-call/     #   transcript segmentation
│   │   ├── segment-llm/      #   LLM-based segmentation
│   │   ├── striking-detect/  #   striking signal detection
│   │   ├── transcribe-deepgram/ # Deepgram transcription
│   │   ├── review-resolve/   #   review queue resolution
│   │   └── admin-reseed/     #   admin re-seeding utility
│   └── migrations/           # Supabase migrations (auto-managed, 452+)
│
├── scripts/                  # Pipeline utility scripts
│
├── tests/                    # Test suites
│   └── identity/             #   identity/contact resolution tests
│
├── artifacts/                # Versioned analysis outputs (read-only reference)
│   └── <name>_<type>_v<N>/   #   one directory per artifact batch
│
├── docs/                     # Product documentation
│   └── identity/             #   identity subsystem docs
│
├── MANIFEST.md               # THIS FILE
├── CLAUDE.md                 # Boot + operating manual
├── README.md                 # Repo overview
├── RELEASES.md               # Release changelog
└── .env.example              # Environment template
```

## Placement Rules

| You're creating...                        | Put it in                          |
|-------------------------------------------|------------------------------------|
| A new Edge Function                       | `supabase/functions/<name>/`       |
| Shared code used by multiple functions    | `supabase/functions/_shared/`      |
| A pipeline utility script                 | `scripts/`                         |
| Test files                                | `tests/`                           |
| Analysis output / eval results            | `artifacts/<descriptive_name>/`    |
| Product documentation                     | `docs/`                            |
| Database migration                        | Use Supabase CLI (`supabase db diff`) — lands in `supabase/migrations/` automatically |

## Prohibited

- **No files in repo root** except the 5 listed (MANIFEST, CLAUDE, README, RELEASES, .env.example).
- **No new top-level directories** without STRAT approval.
- **No credentials or secrets** — use `.env.example` as template only.
- **No TRAM messages** — TRAM lives in orbit, not here.
- **No governance docs** — governance lives in orbit.

## Naming Conventions

| Type              | Pattern                                    | Example                           |
|-------------------|--------------------------------------------|------------------------------------|
| Edge Function dir | `kebab-case`                               | `striking-detect/`                |
| Artifact dir      | `<name>_<type>_v<N>/`                      | `temporal_backtest_report_dev_v1/` |
| Script            | `snake_case.sh` or `kebab-case.sh`         | `replay_call.sh`                  |
| Migration         | Auto-generated by Supabase CLI             | `20260208123456_add_index.sql`    |

## Edge Function Versioning

Version is tracked in code (comment header + `prompt_version` / `router_version`
fields written to DB). Current deployed versions:

| Function          | Version | Supabase Rev | verify_jwt |
|-------------------|---------|-------------|------------|
| context-assembly  | v1.5.0  | v31         | false      |
| ai-router         | v1.7.0  | v40         | false      |
| segment-call      | v2.4.0  | —           | false      |
| striking-detect   | v1.0.0  | —           | false      |
| process-call      | v3.8.3  | —           | false      |

## Artifacts Policy

`artifacts/` contains versioned analysis outputs — eval results, QA packets,
backtest reports. These are **read-only reference data**, not source code.

Rules:
- One directory per artifact batch, named descriptively with version suffix
- Include a README or summary file in each artifact directory
- Do not create artifacts for throwaway analysis — use `tmp/` (gitignored) instead
- Max 20 artifact directories. Archive or consolidate older ones when approaching limit.
